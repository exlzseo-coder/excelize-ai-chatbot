
<!-- Excelize AI Chatbot -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelize AI Assistant - BIM Solutions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.6.2/dist/dotlottie-wc.js" type="module"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .glassmorphism {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .chat-glassmorphism {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .gradient-blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .slide-up {
            animation: slideUp 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .bounce-in {
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .typing-dots {
            display: inline-flex;
            align-items: center;
        }
        
        .typing-dots span {
            height: 8px;
            width: 8px;
            background: #667eea;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .chat-bubble-user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }
        
        .chat-bubble-bot {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .modern-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .modern-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
        
        .modern-input {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .modern-input:focus {
            background: rgba(255, 255, 255, 0.2);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .pulse-ring {
            animation: pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite;
        }
        
        @keyframes pulse-ring {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            100% {
                transform: scale(2.4);
                opacity: 0;
            }
        }
        
        .flash-animation {
            animation: flash 2s ease-in-out infinite;
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .bot-symbol-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Technology Background Styles */
        .tech-grid {
            background-image: 
                linear-gradient(rgba(0, 242, 254, 0.6) 1px, transparent 1px),
                linear-gradient(90deg, rgba(102, 126, 234, 0.5) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: gridMove 20s linear infinite;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }
        
        .floating-particles {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .floating-particles::before,
        .floating-particles::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #00f2fe;
            border-radius: 50%;
            box-shadow: 0 0 20px #00f2fe, 0 0 40px #00f2fe, 0 0 60px #00f2fe;
            animation: particleFloat 8s ease-in-out infinite;
        }
        
        .floating-particles::before {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .floating-particles::after {
            top: 60%;
            right: 15%;
            animation-delay: 4s;
            background: #667eea;
            box-shadow: 0 0 20px #667eea, 0 0 40px #667eea, 0 0 60px #667eea;
        }
        
        @keyframes particleFloat {
            0%, 100% { 
                transform: translateY(0px) translateX(0px);
                opacity: 0.7;
            }
            25% { 
                transform: translateY(-20px) translateX(10px);
                opacity: 1;
            }
            50% { 
                transform: translateY(-10px) translateX(-5px);
                opacity: 0.8;
            }
            75% { 
                transform: translateY(-30px) translateX(15px);
                opacity: 0.9;
            }
        }
        
        .circuit-lines {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><path d="M20 20 L180 20 L180 60 L100 60 L100 140 L180 140 L180 180" stroke="rgba(0,242,254,0.8)" stroke-width="3" fill="none"/><circle cx="100" cy="60" r="4" fill="rgba(0,242,254,1)"/><circle cx="180" cy="140" r="4" fill="rgba(102,126,234,1)"/><path d="M40 180 L40 120 L160 120 L160 40" stroke="rgba(102,126,234,0.7)" stroke-width="2" fill="none"/></svg>');
            background-size: 100px 100px;
            animation: circuitPulse 6s ease-in-out infinite;
        }
        
        @keyframes circuitPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        .hero-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.1"/><circle cx="90" cy="40" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }
        
        .auto-opening {
            animation: autoOpenChat 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        
        @keyframes autoOpenChat {
            0% {
                opacity: 0;
                transform: translateY(100px) translateX(50px) scale(0.3) rotateY(-15deg);
                filter: blur(10px);
            }
            30% {
                opacity: 0.7;
                transform: translateY(30px) translateX(20px) scale(0.7) rotateY(-5deg);
                filter: blur(3px);
            }
            70% {
                opacity: 0.9;
                transform: translateY(-10px) translateX(-5px) scale(1.05) rotateY(2deg);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) translateX(0) scale(1) rotateY(0deg);
                filter: blur(0px);
            }
        }
        
        .welcome-glow {
            animation: welcomeGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes welcomeGlow {
            0% {
                box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
            }
            100% {
                box-shadow: 0 12px 40px rgba(102, 126, 234, 0.6), 0 0 20px rgba(102, 126, 234, 0.4);
            }
        }

        /* Lottie Animation Styles */
        .lottie-glow {
            filter: drop-shadow(0 0 30px rgba(102, 126, 234, 0.8)) drop-shadow(0 0 60px rgba(102, 126, 234, 0.4));
        }
        
        /* Enhanced floating animation for main bot */
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { 
                transform: translateY(0px) scale(1);
            }
            25% { 
                transform: translateY(-8px) scale(1.02);
            }
            50% { 
                transform: translateY(-15px) scale(1.05);
            }
            75% { 
                transform: translateY(-8px) scale(1.02);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">


    <!-- Modern Floating Chat Button -->
    <div id="chatButton" class="fixed bottom-8 right-8 z-50">
        <div class="relative">
            <div class="absolute inset-0 rounded-full bg-gradient-primary pulse-ring"></div>
            <button class="modern-button relative text-white p-5 rounded-full shadow-2xl">
                <i class="fas fa-robot text-2xl"></i>
            </button>
        </div>
    </div>

    <!-- Ultra Modern Chat Window -->
    <div id="chatWindow" class="fixed bottom-28 right-8 w-[520px] h-[700px] chat-glassmorphism rounded-3xl shadow-2xl z-50 hidden flex flex-col overflow-hidden">
        <!-- Modern Chat Header -->
        <div class="bg-black text-white p-4 relative overflow-hidden" style="min-height: 140px;">
            <div class="absolute inset-0 bg-black opacity-95"></div>
            
            <!-- Technology Background Animation -->
            <div class="absolute inset-0 opacity-20">
                <div class="tech-grid"></div>
                <div class="floating-particles"></div>
                <div class="circuit-lines"></div>
            </div>
            
            <div class="relative z-10 flex flex-col items-center justify-center h-full">
                <!-- Main Lottie Animation replacing bot symbol -->
                <div class="mb-3 relative">
                    <div class="relative p-2">
                        <iframe 
                            id="mainBotAnimation"
                            src="https://lottie.host/embed/3298cb72-c35c-4925-8106-b5c9fcd36461/WJhO4nc63A.lottie"
                            style="width: 100px; height: 100px; z-index: 10; border: none; background: transparent;"
                            class="lottie-glow floating-animation">
                        </iframe>
                        

                    </div>
                    
                    <!-- Thinking Animation Rings -->
                    <div id="thinkingRings" class="absolute inset-0 hidden">
                        <div class="absolute inset-0 border-2 border-blue-400 rounded-full animate-ping opacity-75"></div>
                        <div class="absolute inset-2 border-2 border-purple-400 rounded-full animate-ping opacity-50" style="animation-delay: 0.5s;"></div>
                        <div class="absolute inset-4 border-2 border-cyan-400 rounded-full animate-ping opacity-25" style="animation-delay: 1s;"></div>
                    </div>
                    
                    <!-- Brain Activity Indicator -->
                    <div id="brainActivity" class="absolute -top-2 -right-2 w-6 h-6 bg-yellow-400 rounded-full hidden animate-pulse">
                        <i class="fas fa-brain text-xs text-yellow-800 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></i>
                    </div>
                </div>
                
                <!-- Text Content -->
                <div class="text-center">
                    <h3 class="font-bold text-xl mb-1">Excelize AI Assistant</h3>
                    <p class="text-sm opacity-90 flex items-center justify-center">
                        <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                        Your BIM Solutions Partner
                    </p>
                </div>
                
                <button id="closeChat" class="absolute top-4 right-4 text-white hover:text-gray-300 p-2 rounded-full hover:bg-white hover:bg-opacity-10 transition-all">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
        </div>

        <!-- Chat Messages Area -->
        <div id="chatMessages" class="flex-1 p-6 overflow-y-auto space-y-4 bg-gradient-to-br from-gray-50 to-white">
            <div class="chat-bubble-bot p-4 rounded-2xl max-w-xs slide-up">
                <div class="flex items-start space-x-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg">
                        <i class="fas fa-robot text-white text-lg"></i>
                    </div>
                    <div>
                        <p class="text-sm text-gray-700 leading-relaxed mb-3">Welcome to Excelize! ðŸ‘‹ I'm your AI assistant, ready to help you with our BIM solutions. Please choose an option below to get started:</p>
                        
                        <!-- Option Buttons -->
                        <div class="space-y-2 mt-4">
                            <button onclick="selectOption('get_quote')" class="w-full text-left p-3 rounded-xl hover:scale-105 transition-transform text-sm font-medium text-white shadow-lg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                ðŸ’° Get Quote
                            </button>
                            <button onclick="selectOption('job_opening')" class="w-full text-left p-3 rounded-xl hover:scale-105 transition-transform text-sm font-medium text-white shadow-lg" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                ðŸ’¼ Job Openings
                            </button>
                            <button onclick="selectOption('chat_with_ai')" class="w-full text-left p-3 rounded-xl hover:scale-105 transition-transform text-sm font-medium text-white shadow-lg" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                ðŸ¤– Chat with AI
                            </button>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>

        <!-- Modern Chat Input -->
        <div class="p-6 bg-white bg-opacity-80 backdrop-filter backdrop-blur-lg">
            <div class="flex items-center space-x-3 bg-gray-100 rounded-2xl p-2">
                <input id="chatInput" type="text" placeholder="Type your message..." class="flex-1 bg-transparent px-4 py-3 text-sm focus:outline-none placeholder-gray-500">
                <button id="sendMessage" class="modern-button text-white p-3 rounded-xl hover:scale-105 transition-transform">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            <div class="text-center mt-3">
                <span class="text-xs text-gray-500">Powered by <span class="gradient-text font-semibold">Excelize Marketing Team</span></span>
            </div>
        </div>
    </div>

    <!-- Lead Form Inside Chat (Hidden by default) -->
    <div id="leadFormContainer" class="hidden">
        <div class="chat-bubble-bot p-4 rounded-2xl slide-up">
            <div class="flex items-start space-x-3">
                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-lg">
                    <i class="fas fa-robot text-white text-lg"></i>
                </div>
                <div class="flex-1">
                    <div class="text-center mb-4">
                        <h3 id="formTitle" class="text-lg font-bold gradient-text mb-1">Let's Connect!</h3>
                        <p id="formSubtitle" class="text-xs text-gray-600">Share your details and let our experts help you</p>
                    </div>
                    
                    <form id="leadForm" class="space-y-3">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            <div class="relative">
                                <i class="fas fa-user absolute left-3 top-3 text-gray-400 text-sm"></i>
                                <input type="text" id="leadName" required placeholder="Full Name *" class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500">
                            </div>
                            
                            <div class="relative">
                                <i class="fas fa-envelope absolute left-3 top-3 text-gray-400 text-sm"></i>
                                <input type="email" id="leadEmail" required placeholder="Email *" class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            <div class="relative">
                                <i class="fas fa-building absolute left-3 top-3 text-gray-400 text-sm"></i>
                                <input type="text" id="leadCompany" placeholder="Company" class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500">
                            </div>
                            
                            <div class="relative">
                                <i class="fas fa-globe absolute left-3 top-3 text-gray-400 text-sm"></i>
                                <select id="leadCountry" class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500">
                                    <option value="">Country</option>
                                    <option value="US">United States</option>
                                    <option value="UK">United Kingdom</option>
                                    <option value="CA">Canada</option>
                                    <option value="AU">Australia</option>
                                    <option value="IN">India</option>
                                    <option value="AE">UAE</option>
                                    <option value="SG">Singapore</option>
                                    <option value="DE">Germany</option>
                                    <option value="FR">France</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="relative">
                            <i class="fas fa-cogs absolute left-3 top-3 text-gray-400 text-sm"></i>
                            <select id="leadServices" class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500">
                                <option value="">Select Service</option>
                                <option value="bim_modeling">BIM Modeling</option>
                                <option value="scan_to_bim">Scan to BIM</option>
                                <option value="cad_to_bim">CAD to BIM</option>
                                <option value="bim_coordination">BIM Coordination</option>
                                <option value="mep_modeling">MEP Modeling</option>
                                <option value="structural_modeling">Structural Modeling</option>
                                <option value="architectural_modeling">Architectural Modeling</option>
                                <option value="4d_5d_bim">4D/5D BIM</option>
                                <option value="other">Other Services</option>
                            </select>
                        </div>
                        
                        <div class="relative">
                            <i class="fas fa-info-circle absolute left-3 top-3 text-gray-400 text-sm"></i>
                            <textarea id="leadProject" rows="3" placeholder="Project details..." class="w-full pl-8 pr-3 py-3 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 resize-none"></textarea>
                        </div>
                        
                        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 pt-3">
                            <button type="submit" class="w-full sm:flex-1 text-white py-3 rounded-lg font-medium text-sm hover:scale-105 transition-transform shadow-lg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <i class="fas fa-paper-plane mr-2"></i>Submit Request
                            </button>
                            <button type="button" id="closeLead" class="w-full sm:w-auto px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-sm text-gray-600">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        class ExcelizeAIAssistant {
            constructor() {
                this.chatWindow = document.getElementById('chatWindow');
                this.chatButton = document.getElementById('chatButton');
                this.chatMessages = document.getElementById('chatMessages');
                this.chatInput = document.getElementById('chatInput');
                this.leadFormContainer = document.getElementById('leadFormContainer');
                this.leadForm = document.getElementById('leadForm');
                
                this.conversationState = 'greeting';
                this.isTyping = false;
                this.selectedOption = '';
                this.userIP = '';
                this.isFormSubmitted = false; // Track if form is submitted
                this.userDetails = null; // Store user details after form submission
                
                this.initializeEventListeners();
                this.loadKnowledgeBase();
                this.getUserIP();
            }
            
            async getUserIP() {
                try {
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    this.userIP = data.ip;
                } catch (error) {
                    console.log('Could not fetch IP:', error);
                    this.userIP = 'Unknown';
                }
            }
            
            initializeEventListeners() {
                this.chatButton.addEventListener('click', () => this.toggleChat());
                document.getElementById('closeChat').addEventListener('click', () => this.toggleChat());
                document.getElementById('sendMessage').addEventListener('click', () => this.sendMessage());
                this.chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });
                
                this.leadForm.addEventListener('submit', (e) => this.submitLead(e));
                document.getElementById('closeLead').addEventListener('click', () => this.closeLead());
                
                // Make selectOption globally available
                window.selectOption = (option) => this.selectOption(option);
            }
            
            selectOption(option) {
                this.selectedOption = option;
                
                // Special handling for job openings - redirect to careers page
                if (option === 'job_opening') {
                    // Add user message showing their selection
                    this.addMessage('ðŸ’¼ Job Openings', 'user');
                    
                    // Show bot response with redirect message
                    setTimeout(() => {
                        this.addMessage("Great choice! ðŸš€ I'm redirecting you to our careers page where you can explore all available opportunities and apply directly.", 'bot');
                        
                        // Redirect after a short delay
                        setTimeout(() => {
                            window.open('https://excelize.com/about/careers/', '_blank');
                        }, 2000);
                    }, 1000);
                    
                    return; // Exit early for job openings
                }
                
                // Update form title and subtitle based on selection
                const formTitle = document.getElementById('formTitle');
                const formSubtitle = document.getElementById('formSubtitle');
                
                switch(option) {
                    case 'get_quote':
                        formTitle.textContent = 'Get Your Quote';
                        formSubtitle.textContent = 'Tell us about your project and get a customized quote';
                        break;
                    case 'chat_with_ai':
                        formTitle.textContent = 'Chat with AI';
                        formSubtitle.textContent = 'Get instant answers about our BIM services and solutions';
                        break;
                }
                
                // Show the form inside chat
                this.showFormInChat();
                
                // Add user message showing their selection
                const optionText = {
                    'get_quote': 'ðŸ’° Get Quote',
                    'chat_with_ai': 'ðŸ¤– Chat with AI'
                };
                
                this.addMessage(optionText[option], 'user');
            }
            
            loadKnowledgeBase() {
                this.knowledge = {
                    'bim modeling': 'ðŸ—ï¸ Our BIM Modeling service creates detailed 3D digital twins of your buildings using cutting-edge technology. We deliver LOD 300-500 models that enhance collaboration and reduce project risks by up to 40%.',
                    'scan to bim': 'ðŸ“ Scan to BIM transforms laser scan point clouds into intelligent 3D models with 99.9% accuracy. Perfect for renovations, heritage buildings, and as-built documentation.',
                    'cad to bim': 'ðŸ”„ CAD to BIM migration adds intelligence to your 2D drawings, creating parametric 3D models with embedded data for better project management and lifecycle analysis.',
                    'bim coordination': 'ðŸŽ¯ Our BIM Coordination service identifies and resolves conflicts before construction, reducing change orders by 75% and ensuring seamless project delivery.',
                    'services': 'âœ¨ Excelize offers comprehensive BIM solutions: 3D/4D/5D BIM, MEP coordination, clash detection, quantity takeoffs, and virtual construction planning.',
                    'benefits': 'ðŸš€ BIM delivers 25-40% efficiency gains, reduces errors by 80%, improves collaboration, and provides real-time project insights for better decision-making.',
                    'cost': 'ðŸ’° Our competitive pricing starts from $2-5 per sq ft for BIM modeling. Contact us for a customized quote based on your project requirements.',
                    'timeline': 'â±ï¸ Typical project timelines: Small projects (1-2 weeks), Medium projects (2-4 weeks), Large projects (4-8 weeks). Rush delivery available.'
                };
            }
            
            toggleChat() {
                this.chatWindow.classList.toggle('hidden');
                if (!this.chatWindow.classList.contains('hidden')) {
                    this.chatInput.focus();
                    this.chatWindow.classList.add('slide-up');
                }
            }
            
            sendMessage() {
                const message = this.chatInput.value.trim();
                if (!message || this.isTyping) return;
                
                this.addMessage(message, 'user');
                this.chatInput.value = '';
                
                this.showTypingIndicator();
                setTimeout(async () => {
                    this.hideTypingIndicator();
                    await this.processMessage(message);
                }, 1500);
            }
            
            addMessage(message, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `slide-up max-w-xs p-4 rounded-2xl ${
                    sender === 'user' 
                        ? 'chat-bubble-user text-white ml-auto' 
                        : 'chat-bubble-bot text-gray-700'
                }`;
                
                if (sender === 'user') {
                    messageDiv.innerHTML = `
                        <div class="flex items-start space-x-3 justify-end">
                            <p class="text-sm leading-relaxed">${message}</p>
                            <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-user text-white text-sm"></i>
                            </div>
                        </div>
                    `;
                } else {
                    // Play attractive sound for bot messages
                    this.playBotMessageSound();
                    
                    messageDiv.innerHTML = `
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 bg-gradient-primary rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-robot text-white text-sm"></i>
                            </div>
                            <p class="text-sm leading-relaxed">${message}</p>
                        </div>
                    `;
                }
                
                this.chatMessages.appendChild(messageDiv);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }
            
            showTypingIndicator() {
                this.isTyping = true;
                
                // Show AI thinking animation in header
                this.showAIThinking();
                
                const typingDiv = document.createElement('div');
                typingDiv.id = 'typingIndicator';
                typingDiv.className = 'chat-bubble-bot p-4 rounded-2xl max-w-xs slide-up';
                typingDiv.innerHTML = `
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 bg-gradient-primary rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-robot text-white text-sm"></i>
                        </div>
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
                this.chatMessages.appendChild(typingDiv);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }
            
            hideTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
                
                // Hide AI thinking animation in header
                this.hideAIThinking();
                
                this.isTyping = false;
            }
            
            async processMessage(message) {
                const lowerMessage = message.toLowerCase();
                
                // Check if form is submitted - if not, redirect to form
                if (!this.isFormSubmitted) {
                    this.addMessage("I'd love to help you! ðŸ˜Š But first, I need to know a bit about you to provide personalized assistance. Please fill out the quick form below:", 'bot');
                    
                    setTimeout(() => {
                        this.showFormInChat();
                    }, 1000);
                    return;
                }
                
                // If form is submitted, proceed with normal chat
                // Check for lead capture triggers
                if (lowerMessage.includes('help') || lowerMessage.includes('service') || 
                    lowerMessage.includes('quote') || lowerMessage.includes('contact') ||
                    lowerMessage.includes('price') || lowerMessage.includes('cost')) {
                    this.startLeadCapture();
                    return;
                }
                
                // First check knowledge base for quick responses
                let response = this.findBestResponse(lowerMessage);
                
                if (response) {
                    // Use knowledge base response with personalization
                    const personalizedResponse = `Hi ${this.userDetails.name}! ${response}`;
                    this.addMessage(personalizedResponse, 'bot');
                } else {
                    // Use Perplexity AI for complex questions
                    this.addMessage(`Let me get you the most accurate information, ${this.userDetails.name}... ðŸ¤–`, 'bot');
                    
                    // Show typing indicator while getting AI response
                    this.showTypingIndicator();
                    
                    try {
                        const aiResponse = await this.getPerplexityAnswer(message);
                        this.hideTypingIndicator();
                        this.addMessage(aiResponse, 'bot');
                    } catch (error) {
                        this.hideTypingIndicator();
                        this.addMessage("I apologize, but I'm having trouble accessing my knowledge base right now. Let me connect you with our expert team who can help you immediately! ðŸŽ¯", 'bot');
                    }
                }
                
                // Follow up with lead capture suggestion after a delay
                setTimeout(() => {
                    this.addMessage("Would you like to discuss your project requirements with our team? I can arrange a free consultation! ðŸš€", 'bot');
                }, 3000);
            }
            
            findBestResponse(message) {
                for (const [key, value] of Object.entries(this.knowledge)) {
                    if (message.includes(key)) {
                        return value;
                    }
                }
                return null;
            }
            
            showFormInChat() {
                this.leadFormContainer.classList.remove('hidden');
                this.chatMessages.appendChild(this.leadFormContainer);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }
            
            startLeadCapture() {
                this.addMessage("Fantastic! ðŸŽ‰ I'd love to connect you with our BIM specialists. Let me gather some quick details to ensure you get personalized assistance.", 'bot');
                
                setTimeout(() => {
                    this.showFormInChat();
                }, 1200);
            }
            
            submitLead(e) {
                e.preventDefault();
                
                // Get selected service
                const servicesSelect = document.getElementById('leadServices');
                const selectedService = servicesSelect.value;
                
                const leadData = {
                    name: document.getElementById('leadName').value,
                    email: document.getElementById('leadEmail').value,
                    company: document.getElementById('leadCompany').value,
                    country: document.getElementById('leadCountry').value,
                    service: selectedService,
                    project: document.getElementById('leadProject').value,
                    selectedOption: this.selectedOption,
                    userIP: this.userIP,
                    timestamp: new Date().toISOString(),
                    source: 'Excelize AI Assistant'
                };
                
                // Store user details and mark form as submitted
                this.userDetails = leadData;
                this.isFormSubmitted = true;
                
                this.sendToWebhook(leadData);
                this.leadFormContainer.classList.add('hidden');
                
                // Different responses based on selected option
                let responseMessage = '';
                switch(this.selectedOption) {
                    case 'get_quote':
                        responseMessage = `Thank you ${leadData.name}! ðŸ’° Our team will prepare a customized quote for your project and reach out within 24 hours.`;
                        break;
                    case 'job_opening':
                        responseMessage = `Thank you ${leadData.name}! ðŸ’¼ Our HR team will review your profile and contact you about suitable opportunities.`;
                        break;
                    case 'chat_with_ai':
                        responseMessage = `Perfect ${leadData.name}! ðŸ¤– Now you can chat with me freely. I'm here to answer all your BIM-related questions!`;
                        break;
                    default:
                        responseMessage = `Thank you ${leadData.name}! ðŸ™ Our team will reach out to you shortly.`;
                }
                
                this.addMessage(responseMessage, 'bot');
                
                // Enable AI chat after form submission
                setTimeout(() => {
                    if (this.selectedOption === 'chat_with_ai') {
                        this.addMessage("ðŸš€ Great! Now you can ask me anything about BIM services, our solutions, pricing, or any technical questions. I'm ready to help!", 'bot');
                    } else {
                        this.addMessage("ðŸ¤– Bonus: You can now also chat with me about any BIM-related questions while you wait for our team to contact you!", 'bot');
                    }
                }, 2500);
                
                this.leadForm.reset();
                this.selectedOption = '';
            }
            
            async sendToWebhook(data) {
                try {
                    // Form submission webhook - Replace with your actual webhook URL
                    const formWebhookUrl = 'https://hook.us1.make.com/q8fcq28tytrbbiaxvn2j1xtq8e4i89b5';
                    
                    const response = await fetch(formWebhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    if (response.ok) {
                        console.log('Lead data sent successfully');
                    }
                } catch (error) {
                    console.error('Error sending lead data:', error);
                    console.log('Lead Data (Demo):', data);
                }
            }
            
            async getPerplexityAnswer(question) {
                try {
                    // Perplexity AI webhook - Replace with your actual webhook URL
                    const perplexityWebhookUrl = 'https://hook.us1.make.com/vtufan7vvlln5goiugovy1n5ktftf7mx';
                    
                    console.log('ðŸš€ SENDING REQUEST TO MAKE.COM WEBHOOK...');
                    console.log('ðŸ“¤ Request URL:', perplexityWebhookUrl);
                    console.log('ðŸ“¤ Request Body:', {
                        question: question,
                        context: 'BIM solutions, construction technology, architectural modeling, Excelize services',
                        timestamp: new Date().toISOString(),
                        user_ip: this.userIP
                    });
                    
                    const response = await fetch(perplexityWebhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            question: question,
                            context: 'BIM solutions, construction technology, architectural modeling, Excelize services',
                            timestamp: new Date().toISOString(),
                            user_ip: this.userIP
                        })
                    });
                    
                    console.log('ðŸ“¡ RESPONSE STATUS:', response.status, response.statusText);
                    console.log('ðŸ“¡ RESPONSE HEADERS:', Object.fromEntries(response.headers.entries()));
                    
                    if (response.ok) {
                        // First get the raw text to see what we're dealing with
                        const rawText = await response.text();
                        console.log('ðŸ“„ RAW RESPONSE TEXT:', rawText);
                        console.log('ðŸ“ RAW TEXT LENGTH:', rawText.length);
                        
                        // Try to parse as JSON
                        let result;
                        try {
                            result = JSON.parse(rawText);
                            console.log('âœ… SUCCESSFULLY PARSED JSON');
                        } catch (parseError) {
                            console.log('âŒ JSON PARSE ERROR:', parseError.message);
                            console.log('ðŸ”§ Treating as plain text response');
                            
                            // If it's not JSON, treat as plain text
                            if (rawText.trim().length > 5) {
                                const cleanText = rawText.trim()
                                    .replace(/\\n/g, '\n')
                                    .replace(/\\r/g, '\r')
                                    .replace(/\\t/g, '\t')
                                    .replace(/\\"/g, '"')
                                    .replace(/\\'/g, "'");
                                
                                console.log('âœ… RETURNING PLAIN TEXT RESPONSE');
                                return cleanText;
                            } else {
                                return "I received an empty response from the server. Please try again.";
                            }
                        }
                        
                        console.log('ðŸ“¦ PARSED JSON RESPONSE:', JSON.stringify(result, null, 2));
                        console.log('ðŸ” RESPONSE TYPE:', typeof result);
                        console.log('ðŸ—‚ï¸ RESPONSE KEYS:', Object.keys(result || {}));
                        
                        let aiAnswer = '';
                        
                        // COMPREHENSIVE PARSING WITH DETAILED LOGGING
                        console.log('ðŸ” STARTING COMPREHENSIVE RESPONSE PARSING...');
                        
                        // Method 1: Direct string response
                        if (typeof result === 'string' && result.trim().length > 5) {
                            aiAnswer = result.trim();
                            console.log('âœ… METHOD 1: Found direct string response');
                        }
                        
                        // Method 2: Check standard content keys
                        if (!aiAnswer && result && typeof result === 'object') {
                            const contentKeys = [
                                'content', 'text', 'answer', 'response', 'message', 'result',
                                'data', 'output', 'reply', 'completion', 'generated_text', 'body'
                            ];
                            
                            console.log('ðŸ” METHOD 2: Checking standard content keys...');
                            for (const key of contentKeys) {
                                console.log(`ðŸ”Ž Checking key "${key}":`, result[key]);
                                if (result[key] && typeof result[key] === 'string' && result[key].trim().length > 5) {
                                    aiAnswer = result[key].trim();
                                    console.log(`âœ… METHOD 2: Found content in result.${key}`);
                                    break;
                                }
                            }
                        }
                        
                        // Method 3: Check ALL keys in the response object
                        if (!aiAnswer && result && typeof result === 'object') {
                            console.log('ðŸ” METHOD 3: Checking ALL keys in response...');
                            const allKeys = Object.keys(result);
                            console.log('ðŸ—‚ï¸ ALL AVAILABLE KEYS:', allKeys);
                            
                            for (const key of allKeys) {
                                console.log(`ðŸ”Ž Examining key "${key}":`, typeof result[key], result[key]);
                                
                                // Check if it's a direct string
                                if (typeof result[key] === 'string' && result[key].trim().length > 5) {
                                    aiAnswer = result[key].trim();
                                    console.log(`âœ… METHOD 3: Found string content at key "${key}"`);
                                    break;
                                }
                                
                                // Check if it's an object with content
                                if (result[key] && typeof result[key] === 'object') {
                                    console.log(`ðŸ” Key "${key}" is an object, checking its properties...`);
                                    
                                    // Check for choices array (OpenAI format)
                                    if (result[key].choices && Array.isArray(result[key].choices)) {
                                        console.log(`âœ… Found choices array in key "${key}"`);
                                        
                                        for (let i = 0; i < result[key].choices.length; i++) {
                                            const choice = result[key].choices[i];
                                            console.log(`ðŸ”Ž Checking choice ${i}:`, choice);
                                            
                                            if (choice && choice.message && choice.message.content) {
                                                aiAnswer = choice.message.content;
                                                console.log(`âœ… METHOD 3: Found content at ${key}.choices[${i}].message.content`);
                                                break;
                                            }
                                            
                                            if (choice && typeof choice.content === 'string' && choice.content.trim().length > 5) {
                                                aiAnswer = choice.content.trim();
                                                console.log(`âœ… METHOD 3: Found content at ${key}.choices[${i}].content`);
                                                break;
                                            }
                                        }
                                        
                                        if (aiAnswer) break;
                                    }
                                    
                                    // Check for direct content properties in the object
                                    const subKeys = Object.keys(result[key]);
                                    console.log(`ðŸ—‚ï¸ Sub-keys in "${key}":`, subKeys);
                                    
                                    for (const subKey of subKeys) {
                                        console.log(`ðŸ”Ž Checking ${key}.${subKey}:`, result[key][subKey]);
                                        if (result[key][subKey] && typeof result[key][subKey] === 'string' && result[key][subKey].trim().length > 5) {
                                            aiAnswer = result[key][subKey].trim();
                                            console.log(`âœ… METHOD 3: Found content at ${key}.${subKey}`);
                                            break;
                                        }
                                    }
                                    
                                    if (aiAnswer) break;
                                }
                            }
                        }
                        
                        // Method 4: Deep recursive search
                        if (!aiAnswer) {
                            console.log('ðŸ” METHOD 4: Performing deep recursive search...');
                            const deepSearch = (obj, path = '', depth = 0) => {
                                if (depth > 15) {
                                    console.log(`âš ï¸ Max depth reached at ${path}`);
                                    return null;
                                }
                                
                                console.log(`ðŸ”Ž Deep search at ${path || 'root'} (depth ${depth}):`, typeof obj);
                                
                                if (typeof obj === 'string' && obj.trim().length > 10) {
                                    console.log(`âœ… Found text at ${path}:`, obj.substring(0, 100) + '...');
                                    return obj.trim();
                                }
                                
                                if (Array.isArray(obj)) {
                                    console.log(`ðŸ“‹ Array found at ${path} with ${obj.length} items`);
                                    for (let i = 0; i < obj.length; i++) {
                                        const found = deepSearch(obj[i], `${path}[${i}]`, depth + 1);
                                        if (found) return found;
                                    }
                                }
                                
                                if (typeof obj === 'object' && obj !== null) {
                                    const objKeys = Object.keys(obj);
                                    console.log(`ðŸ—‚ï¸ Object at ${path} has keys:`, objKeys);
                                    
                                    for (const key of objKeys) {
                                        const found = deepSearch(obj[key], path ? `${path}.${key}` : key, depth + 1);
                                        if (found) return found;
                                    }
                                }
                                
                                return null;
                            };
                            
                            aiAnswer = deepSearch(result);
                        }
                        
                        console.log('ðŸŽ¯ FINAL EXTRACTED ANSWER:', aiAnswer);
                        
                        if (aiAnswer && aiAnswer.length > 3) {
                            // Enhanced cleaning
                            let cleanAnswer = aiAnswer
                                .replace(/\\n/g, '\n')
                                .replace(/\\r/g, '\r')
                                .replace(/\\t/g, '\t')
                                .replace(/\\"/g, '"')
                                .replace(/\\'/g, "'")
                                .replace(/^\"|\"$/g, '')
                                .replace(/^'|'$/g, '')
                                .replace(/^`|`$/g, '')
                                .trim();
                            
                            // Remove extra whitespace
                            cleanAnswer = cleanAnswer.replace(/\s+/g, ' ').trim();
                            
                            console.log('âœ¨ CLEANED ANSWER:', cleanAnswer);
                            
                            if (cleanAnswer.length > 3) {
                                return cleanAnswer;
                            }
                        }
                        
                        // If still no answer, provide detailed debugging info
                        console.log('âŒ NO VALID TEXT FOUND IN RESPONSE');
                        console.log('ðŸ”§ COMPLETE RESPONSE STRUCTURE:');
                        console.log(JSON.stringify(result, null, 2));
                        
                        // Show the user what we received for debugging
                        const debugInfo = {
                            responseType: typeof result,
                            responseKeys: Object.keys(result || {}),
                            sampleData: JSON.stringify(result).substring(0, 300)
                        };
                        
                        return `ðŸ”§ DEBUG INFO: I received a response but couldn't extract readable text. 
                        
Response Type: ${debugInfo.responseType}
Available Keys: ${debugInfo.responseKeys.join(', ')}
Sample Data: ${debugInfo.sampleData}...

Please check the browser console for the complete response structure and share it with the developer.`;
                        
                    } else {
                        const errorText = await response.text();
                        console.error('âŒ HTTP ERROR:', response.status, response.statusText);
                        console.error('ðŸ“„ ERROR RESPONSE BODY:', errorText);
                        throw new Error(`HTTP ${response.status}: ${response.statusText} - ${errorText}`);
                    }
                } catch (error) {
                    console.error('ðŸ’¥ COMPLETE ERROR DETAILS:');
                    console.error('Error Name:', error.name);
                    console.error('Error Message:', error.message);
                    console.error('Error Stack:', error.stack);
                    console.error('Full Error Object:', error);
                    
                    return `ðŸš¨ Connection Error: ${error.message}. Please check the browser console for detailed error information and try again.`;
                }
            }
            
            closeLead() {
                this.leadFormContainer.classList.add('hidden');
                this.addMessage("No worries! ðŸ˜Š I'm here whenever you're ready to explore our BIM solutions. Feel free to ask me anything!", 'bot');
            }
            
            autoOpenChat() {
                // Play notification sound when chatbot opens
                this.playNotificationSound();
                
                // Add special auto-open animation class
                this.chatWindow.classList.add('auto-opening');
                this.chatWindow.classList.remove('hidden');
                this.chatWindow.classList.add('slide-up');
                
                // Focus on input after animation
                setTimeout(() => {
                    this.chatInput.focus();
                    this.chatWindow.classList.remove('auto-opening');
                }, 600);
                
                // Add continuous welcome glow effect to chat window
                setTimeout(() => {
                    this.chatWindow.classList.add('welcome-glow');
                    // Glow effect will continue permanently - no removal
                }, 1000);
            }
            
            playNotificationSound() {
                // Create audio context for notification sound
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Create a pleasant notification sound
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // Set frequency for a pleasant notification tone
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);
                    
                    // Set volume envelope
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.05);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    // Play the sound
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                    
                } catch (error) {
                    console.log('Audio not supported or blocked:', error);
                }
            }
            
            showAIThinking() {
                const thinkingRings = document.getElementById('thinkingRings');
                const brainActivity = document.getElementById('brainActivity');
                const mainBotAnimation = document.getElementById('mainBotAnimation');
                
                if (thinkingRings && brainActivity) {
                    thinkingRings.classList.remove('hidden');
                    brainActivity.classList.remove('hidden');
                }
                
                // Add thinking effects to Lottie animation
                if (mainBotAnimation) {
                    mainBotAnimation.classList.add('scale-110', 'shadow-2xl');
                    mainBotAnimation.style.filter = 'drop-shadow(0 0 40px rgba(102, 126, 234, 1)) drop-shadow(0 0 80px rgba(102, 126, 234, 0.6))';
                    mainBotAnimation.style.transform = 'scale(1.1) translateY(-5px)';
                    mainBotAnimation.style.transition = 'all 0.3s ease';
                    
                    // Speed up animation during thinking
                    if (mainBotAnimation.speed !== undefined) {
                        mainBotAnimation.speed = 1.5;
                    }
                }
            }
            
            hideAIThinking() {
                const thinkingRings = document.getElementById('thinkingRings');
                const brainActivity = document.getElementById('brainActivity');
                const mainBotAnimation = document.getElementById('mainBotAnimation');
                
                if (thinkingRings && brainActivity) {
                    thinkingRings.classList.add('hidden');
                    brainActivity.classList.add('hidden');
                }
                
                // Remove thinking effects from Lottie animation
                if (mainBotAnimation) {
                    mainBotAnimation.classList.remove('scale-110', 'shadow-2xl');
                    mainBotAnimation.style.filter = 'drop-shadow(0 0 30px rgba(102, 126, 234, 0.8)) drop-shadow(0 0 60px rgba(102, 126, 234, 0.4))';
                    mainBotAnimation.style.transform = 'scale(1) translateY(0px)';
                    
                    // Reset animation speed
                    if (mainBotAnimation.speed !== undefined) {
                        mainBotAnimation.speed = 1;
                    }
                }
            }
            
            playBotMessageSound() {
                // Create attractive sound for bot messages
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Create multiple oscillators for a richer sound
                    const osc1 = audioContext.createOscillator();
                    const osc2 = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    osc1.connect(gainNode);
                    osc2.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // Create a pleasant "ding-dong" melody
                    osc1.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    osc1.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.15); // E5
                    
                    osc2.frequency.setValueAtTime(392.00, audioContext.currentTime); // G4
                    osc2.frequency.setValueAtTime(523.25, audioContext.currentTime + 0.15); // C5
                    
                    // Set volume envelope for smooth sound
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + 0.05);
                    gainNode.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + 0.15);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                    
                    // Play the sound
                    osc1.start(audioContext.currentTime);
                    osc1.stop(audioContext.currentTime + 0.4);
                    osc2.start(audioContext.currentTime);
                    osc2.stop(audioContext.currentTime + 0.4);
                    
                } catch (error) {
                    console.log('Audio not supported or blocked:', error);
                }
            }
        }
        
        // Initialize the Excelize AI Assistant
        document.addEventListener('DOMContentLoaded', () => {
            const assistant = new ExcelizeAIAssistant();
            
            // Check if Lottie animation loads properly
            const lottiePlayer = document.getElementById('mainBotAnimation');
            
            // Listen for Lottie load events
            if (lottiePlayer) {
                lottiePlayer.addEventListener('ready', () => {
                    console.log('Lottie animation loaded successfully');
                });
                
                lottiePlayer.addEventListener('error', () => {
                    console.log('Lottie animation error');
                });
            }
            
            // Auto-open chat with amazing animation after 2 seconds
            setTimeout(() => {
                assistant.autoOpenChat();
            }, 2000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ad896784aa419f',t:'MTc1NDQ3Mjg0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
